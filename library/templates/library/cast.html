{% extends 'base.html' %}

{% block title %}{% firstof details.title details.name %} - Cast{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row mb-4">
    <div class="col-12">
      <div class="d-flex align-items-center gap-3 mb-3">
        <div class="flex-shrink-0">
          {% if details.poster_path %}
            <img src="https://image.tmdb.org/t/p/w92{{ details.poster_path }}"
                 alt="{% firstof details.title details.name %}"
                 class="img-fluid rounded shadow-sm"
                 style="width: 80px; height: 120px; object-fit: cover;">
          {% else %}
            <div class="bg-secondary rounded d-flex align-items-center justify-content-center" style="width: 80px; height: 120px;">
              <i class="bi bi-image text-light fs-4"></i>
            </div>
          {% endif %}
        </div>
        <div>
          <h1 class="display-6 fw-bold mb-2">
            {% firstof details.title details.name %}{% if title %} - {{ title }}{% endif %}
          </h1>
          <a href="{% url media_type|add:'_details' media_id=details.id %}" class="text-decoration-none text-muted">
            <i class="bi bi-arrow-left"></i> Back to main
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-12">
      <h2 class="fw-bold mb-4">Cast <span class="text-muted fs-5">{{ cast_count }}</span></h2>

      {% if cast_list %}
        <div class="row g-4">
          {% for actor in cast_list %}
            <div class="col-sm-6 col-md-4 col-lg-3 col-xl-2">
              <div class="card border-0 shadow-sm h-100">
                {% if actor.profile_path %}
                  <img src="https://image.tmdb.org/t/p/w300{{ actor.profile_path }}"
                       class="card-img-top"
                       alt="{{ actor.name }}"
                       style="height: 300px; object-fit: cover; border-radius: 8px 8px 0 0;">
                {% else %}
                  <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 300px; border-radius: 8px 8px 0 0;">
                    <i class="bi bi-person-circle display-1 text-muted"></i>
                  </div>
                {% endif %}
                <div class="card-body p-3">
                  <h6 class="card-title fw-bold mb-2">{{ actor.name }}</h6>
                  <p class="card-text text-muted small mb-0">
                    {% if media_type == 'tv' and actor.roles %}
                      {% for role in actor.roles %}
                        {{ role.character }}{% if not forloop.last %}, {% endif %}
                      {% endfor %}
                    {% else %}
                      {{ actor.character|default:"" }}
                    {% endif %}
                  </p>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="text-center py-5">
          <i class="bi {{ icon }} display-1 text-muted mb-3"></i>
          <p class="text-muted fs-5">{{ title }}</p>
          {% if subtitle %}
            <p class="text-muted">{{ subtitle }}</p>
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}